# 自動化説明資料.md

## 概要
この資料は、Github Actionsを用いて開発リポジトリの更新をドキュメント作成用のリポジトリに自動で反映し、ドキュメントもAIによって常に最新化する仕組みについて、初心者でも理解できるように解説します。各工程や用語の意味も丁寧に説明します。用語解説が最後にあるので適宜確認してください。

## GitHub Actionsについて
GitHub上で自動化処理を実行する仕組み。テストやデプロイ、ドキュメント生成など幅広く利用されます。
  - 基本的な使い方：
    1. `.github/workflows`フォルダにYAML形式のワークフローファイル（例：update_submodule.yml）を作成します。
    2. ファイル内で「いつ」「何を」自動化するかを設定します（例：push時や手動実行、外部通知など）。
    3. 自動化の結果やログはGitHub上で確認できます。

---
## この自動化の目的
開発リポジトリのmainブランチの更新を、ドキュメント作成用のリポジトリに反映し、ドキュメントもAIによって最新化することが目的です。

---

## 自動化されるワークフローの流れ

### 1. 開発リポジトリの更新と通知
- 開発用のコード（サブモジュール）が更新されると、dispatch_update.yml（開発リポジトリのワークフローファイル）の仕組みにより、その更新情報がドキュメント作成用リポジトリに通知されます。

### 2. ドキュメント作成用リポジトリでの通知の受信とサブモジュールの最新化
- ドキュメント作成用リポジトリは、通知を受け取るとupdate_submodule.yml（ドキュメント作成用リポジトリのワークフローファイル）のワークフローが自動で実行されます（これ以降のフローもupdate_submodule.ymlによって自動化されています）。
- これにより、ドキュメント作成用リポジトリに登録されているサブモジュール（開発用リポジトリ）が最新の状態に更新されます。

### 3. GitHub Issueの自動作成
- サブモジュールの更新が完了した後、GitHub Issueが自動で作成されます。
- このIssueに「更新された内容をもとにドキュメントを更新して」というような依頼をおこないます（指定したプロンプトを自動で入力してくれます）。
- Issue（イシュー）とは？
  - GitHub上で「やるべきこと」や「依頼」を記録する機能です。

### 4. Copilotへのドキュメント自動更新依頼
- 作成したリポジトリのAssigneeにcopilotを自動で追加します。これによってAIにドキュメント更新を依頼することができます。

### 5. Pull Request（PR）の自動作成
- サブモジュール更新後、差分があれば自動でPull Request(PR)を作成します。
- copilotがAGENTS.mdやSKILL.mdを自動で読み取り、記載されている内容を加味して資料の更新を行います。
- PRを人間がレビューして問題なければプルリクエストを承認＆マージし、ドキュメントの自動更新が完了します。（今後、本番環境で資料の更新内容が問題なければ、プルリクエスト作成ではなく、自動でドキュメントの更新内容をプッシュすることも検討）

---
## 図解（イメージ）

```
開発用リポジトリ(mainブランチ更新)
  │
  └─▶ dispatch_update.yml（通知ワークフローが起動）
           │
           ▼
ドキュメント作成用リポジトリ
  └─▶ update_submodule.yml（サブモジュール最新化・Issues生成・AIでドキュメント分析・PR作成）
           │
           ▼
        PRで更新内容を人間がレビューし、問題なければ承認＆マージ
           │
           ▼
        ドキュメントの更新完了
```

---

## 実際に必要な準備・作業
- 各リポジトリに必要なワークフローファイル（開発リポジトリはdispatch_update.yml, ドキュメント作成用リポジトリはupdate_submodule.yml）を作成する
- サブモジュールの設定（ドキュメント作成用リポジトリに開発用リポジトリをサブモジュールとして追加）
- CopilotやGitHub Actionsで必要なトークン・シークレット（PATやGitHub Appトークンなど）を発行・設定する
  - 具体例：
    - GitHub Actionsでリポジトリ間の通知やpush、Issue作成などを行う場合、Personal Access Token（PAT）やGitHub Appトークンが必要になります。
    - 開発リポジトリでは、GitHub Appトークンを使って外部リポジトリ（ドキュメント作成用リポジトリ）へ通知を送ります。
    - ドキュメント作成用リポジトリでは、PATを使ってリポジトリへのpushやIssue作成、Pull Request作成を自動化します。
    - Copilotによる自動生成やIssueの自動作成にも、適切な権限を持つトークンが必要です。
- IssuesでCopilotを利用するために有料プランに加入している必要があります。


---

## まとめ
この自動化により、開発用コードの最新内容がドキュメント作成用リポジトリに自動で反映され、ドキュメントもAIによって常に最新化されます。手動作業を減らし、ドキュメントの鮮度と正確性を保つ仕組みです。

---

## よく使われる用語解説
- **Github submodule**：他のリポジトリの内容を一部として取り込む仕組み。複数プロジェクトの連携に便利です。デフォルトだと内容を最新に更新することができないため、今回のように更新を自動化する仕組みが必要です。
- **Issue**：やるべきことや依頼を記録する機能。タスク管理やバグ報告に使われます。
- **Pull Request（PR）**：変更内容をレビュー・承認してもらうための申請です。
- **Personal Access Token（PAT）**：GitHubユーザーが発行できる認証用トークン。APIやGitHub Actionsなどでリポジトリ操作（pushやIssue作成など）を自動化する際に利用。必要な権限を選んで発行し、セキュリティのため公開しない。
- **GitHub Appトークン**：GitHub App（アプリ）経由で発行される認証用トークン。組織や複数リポジトリをまたいだ自動化や通知、外部連携などで利用。Appの権限設定に応じて必要な操作が可能。

---
